<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.miniminishop.mapper.MiniminishopMapper">

  <insert id="insertDelivery">
    <![CDATA[
    insert into delivery(
		delivery_status, member_id
	) values (
		#{deliveryStatus}, #{memberId}
	)
    ]]>
  </insert>

  <update id="updateDelivery">
    <![CDATA[
    update delivery set
		delivery_status = #{deliveryStatus}
	where delivery_id = #{deliveryId}
    ]]>
  </update>

  <insert id="insertItem">
    <![CDATA[
    insert into item (
		item_name, item_amount, item_price
	) values (
		#{itemName}, #{itemAmount}, #{itemPrice}
	)
    ]]>
  </insert>

  <delete id="deleteItem">
    <![CDATA[
    delete from item i
	where i.item_id = #{itemId}
    ]]>
  </delete>

  <update id="updateItem">
    <![CDATA[
    update item set
        update_dt = NOW()
		<if test='itemName != null and itemName != ""'>, item_name = #{itemName}</if>
		<if test='itemAmount != null and itemAmount != ""'>, item_amount = #{itemAmount}</if>
		<if test='itemPrice != null and itemPrice != ""'>, item_price = #{itemPrice}</if>
	where item_id = #{itemId}
    ]]>
  </update>

  <select id="selectItemList" resultType="ItemVo">
    <![CDATA[
    select
		item_id, item_name, item_amount, item_price
	from
		item
    ]]>
  </select>

  <select id="selectItemByName" resultType="ItemVo">
    <![CDATA[
    select
		item_id, item_name, item_amount, item_price
	from
		item
	where item_name contact('%', #{itenName}, '%')
    ]]>
  </select>

  <select id="selectItemById" resultType="ItemVo">
    <![CDATA[
    select
		item_id, item_name, item_amount, item_price
	from
		item
	where item_id = #{itemId}
    ]]>
  </select>

  <insert id="insertOrder">
    <![CDATA[
    insert into orders(
		order_status, member_id, delivery_id
	) values (
		#{orderStatus}, #{memberId}, #{deliveryId}
	)
    ]]>
  </insert>

  <update id="updateOrderStatus">
    <![CDATA[
    update orders set
		order_status = #{orderStatus}
	where
		order_id = #{orderId}
    ]]>
  </update>

  <insert id="insertMember">
    <![CDATA[
    insert into member (
		member_type, member_name, member_phone
	) values (
		#{memberType}, #{memberName}, #{memberPhone}
	)
    ]]>
  </insert>

  <select id="selectMemberList" resultType="MemberVo">
    <![CDATA[
    select * from member
    ]]>
  </select>

  <select id="selectMemberById" resultType="MemberVo">
    <![CDATA[
    select * from member
	where member_id = #{memberId}
    ]]>
  </select>

  <insert id="insertOrderItem">
    <![CDATA[
    insert into orderitem (
		member_id, item_id, item_price, item_amount, order_id
	) values (
		#{memberId}, #{itemId}, #{itemPrice}, #{itemAmount}, #{orderId}
	)
    ]]>
  </insert>

  <delete id="deleteOneOrderItem">
    <![CDATA[
    delete from orderitem
	where member_id = #{memberId} and item_id = #{itemId}
    ]]>
  </delete>

  <select id="selectOrderitemByOrderId" resultType="OrderitemVo">
    <![CDATA[
    select * from orderitem
	where order_id = #{orderId}
    ]]>
  </select>
</mapper>
